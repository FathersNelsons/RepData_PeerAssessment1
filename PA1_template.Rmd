---
title: "Reproducible Research: Peer Assessment 1"
Author: "Grayson Udstrand"
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data
### 1. Loading in the data
  
First, in order to save processing time and unnecessary downloads, check to see
if the working data frame exists in the environment. If it does, move on.  
 
```{r}
if (!exists("activity")) {
        download.file(
                "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip",
                destfile = "data.zip")
        unzip("data.zip", overwrite = TRUE)
        activity <- read.csv("activity.csv", na.strings = "NA")
}
```

Running `str(activity)` on the data reveals we may need to perform some
processing to make this useful:

```{r}
str(activity)
```


### 2. Processing the data
We have already specified in the import process that values "NA" should be
imported as such when we read in the data, so no further work is needed there. 
As for dates, they can be useful as factors but they will be more useful in 
their native form. We will convert that column to dates. Finally, we see that
`interval` is represented as a column of `ints`, but since we know these are
used as identifiers to represent a 5 minute interval that repeats every day, we
should convert this to a factor. We will use the `dplyr` package.

```{r message=FALSE}
library(dplyr)
activity <- mutate(activity, 
                   date = as.Date(as.character(date)), 
                   interval = as.factor(interval))
str(activity)
```

Our `str` confirms that the data is all ready for us to start working with it!

## What is mean total number of steps taken per day?
### 1. Create a histogram for total steps each day

```{r}
activity_daily_total <- aggregate(steps ~ date, activity, sum)
hist(activity_daily_total$steps)
```

### 2. Calculate the mean and median total number of steps per day
```{r}
mean(activity_daily_total$steps)
median(activity_daily_total$steps)
```


## What is the average daily activity pattern?
### 1. Make a time-series plot of the average number of steps taken per 5 minute interval across all days  
  
We create a new data frame which takes the mean number of steps by interval across the whole dataset. It is then easy to use the base plotting package to put together a relatively informative plot as you can see below.  

```{r, message=FALSE}
interval_mean <- aggregate(steps ~ interval, activity, mean)
with(interval_mean, 
     plot(interval, 
          steps, 
          type = "l", 
          xlab = "Interval", 
          ylab = "Mean Steps", 
          main = "Mean Steps by Interval Across All Days"))
```

### 2. Which 5-minute interval on average across all contains the maximum number of steps?

```{r}
interval_mean[which.max(interval_mean$steps),]
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
